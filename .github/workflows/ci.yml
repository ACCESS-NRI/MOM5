name: CI
on:
  pull_request:
jobs:
  build-and-test:
    name: Build and Test
    strategy:
      fail-fast: false
      matrix:
        manifests:
          - .github/build-ci/templates/basic.spack.yaml.j2
          - .github/build-ci/templates/access-om2.spack.yaml.j2
          - .github/build-ci/templates/access-om3.spack.yaml.j2
          - .github/build-ci/templates/access-esm1p5.spack.yaml
          - .github/build-ci/templates/access-esm1p6.spack.yaml.j2
    uses: access-nri/build-ci/.github/workflows/ci.yml@build-ci-2.0
    with:
      spack-manifest-path: ${{ matrix.manifests }}
      allow-ssh-into-spack-install: false
